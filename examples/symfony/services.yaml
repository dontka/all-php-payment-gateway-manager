# Symfony Services Configuration
# config/packages/payment.yaml

services:
  # Payment Manager service
  payment.manager:
    class: PaymentGateway\Core\PaymentManager
    public: true
    arguments:
      - '%env(PAYPAL_CLIENT_ID)%'
      - '%env(PAYPAL_CLIENT_SECRET)%'
      - '%env(PAYPAL_MODE)%'

  # PayPal Gateway
  payment.gateway.paypal:
    class: PaymentGateway\Gateways\PayPalGateway
    arguments:
      - '%env(PAYPAL_CLIENT_ID)%'
      - '%env(PAYPAL_CLIENT_SECRET)%'
      - '%env(PAYPAL_MODE)%'

  # Stripe Gateway (optional)
  payment.gateway.stripe:
    class: PaymentGateway\Gateways\StripeGateway
    arguments:
      - '%env(STRIPE_API_KEY)%'
      - '%env(STRIPE_SECRET_KEY)%'

  # Controllers
  App\Controller\PaymentController:
    arguments:
      - '@payment.manager'
      - '@logger'

  App\Controller\WebhookController:
    arguments:
      - '@payment.manager'
      - '@logger'
      - '@doctrine.orm.entity_manager'

# Parameters
parameters:
  payment.webhook_secret: '%env(PAYMENT_WEBHOOK_SECRET)%'
  payment.log_channel: '%env(PAYMENT_LOG_CHANNEL|default:single)%'

# Environment variables needed in .env or .env.local:
# PAYPAL_CLIENT_ID=your_sandbox_client_id
# PAYPAL_CLIENT_SECRET=your_sandbox_secret
# PAYPAL_MODE=sandbox
# STRIPE_API_KEY=sk_test_your_key
# STRIPE_SECRET_KEY=sk_test_your_secret
